<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MG Cafe & Restro - Authentic Bihari Cuisine & Modern Vibes.">
    <title>MG Cafe & Restro</title>
    
    <!-- Tailwind CSS (Modern Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;700;900&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#d32f2f',
                        secondary: '#388e3c',
                        dark: '#1a1a1a',
                        gold: '#ffb300',
                    },
                    fontFamily: {
                        serif: ['Merriweather', 'serif'],
                        sans: ['Open Sans', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom Animations */
        .fade-in { animation: fadeIn 0.8s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Smooth Scroll */
        html { scroll-behavior: smooth; }
        
        /* Loading Spinner */
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #d32f2f; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-white text-gray-800 font-sans antialiased pb-20 md:pb-0">

    <!-- Loading Screen -->
    <div id="loading-screen" class="fixed inset-0 bg-white z-[9999] flex flex-col items-center justify-center transition-opacity duration-500">
        <div class="loader mb-4"></div>
        <p class="text-gray-500 font-semibold tracking-wide">Swad-E-Bihar is loading...</p>
    </div>

    <!-- MAIN EDITABLE CONTENT -->
    <!-- This ID is crucial for the Admin Panel to target -->
    <main id="editable-content" class="opacity-0 transition-opacity duration-700">
        
        <!-- Hero Section -->
        <section class="relative h-screen min-h-[600px] flex items-center bg-cover bg-center bg-fixed" style="background-image: linear-gradient(to right, rgba(255,255,255,0.95), rgba(255,255,255,0.7)), url('https://images.unsplash.com/photo-1555396273-367ea4eb4db5?ixlib=rb-1.2.1&auto=format&fit=crop&w=1920&q=80');">
            <div class="container mx-auto px-6 grid md:grid-cols-2 gap-12 items-center">
                <div class="text-center md:text-left pt-16 md:pt-0">
                    <span class="inline-block py-1 px-3 rounded-full bg-orange-100 text-orange-600 text-sm font-bold mb-4 tracking-wider">EST. 2024</span>
                    <h1 class="text-5xl md:text-6xl font-serif font-black text-gray-900 leading-tight mb-4">
                        MG CAFE <br> <span class="text-primary">& RESTRO</span>
                    </h1>
                    <p class="text-xl md:text-2xl text-gray-600 mb-8 font-serif italic">"Swad-E-Bihar"</p>
                    <p class="text-gray-600 mb-8 leading-relaxed max-w-lg mx-auto md:mx-0">
                        Experience the authentic taste of Champaran Meat House blended with a modern family cafe vibe. The pride of Danapur.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center md:justify-start">
                        <a href="#booking-section" class="px-8 py-4 bg-primary text-white rounded-full font-bold shadow-lg hover:bg-red-700 hover:shadow-xl transform hover:-translate-y-1 transition duration-300 text-center">
                            Book VIP Table
                        </a>
                        <a href="#menu-section" class="px-8 py-4 bg-white text-gray-800 border border-gray-200 rounded-full font-bold shadow hover:bg-gray-50 transition duration-300 text-center flex items-center justify-center gap-2">
                            <i class="fas fa-utensils text-primary"></i> View Menu
                        </a>
                    </div>
                </div>
                <div class="hidden md:block">
                     <!-- High quality food image -->
                     <img src="https://images.unsplash.com/photo-1543353071-873f17a7a088?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" alt="Delicious Food" class="rounded-3xl shadow-2xl transform rotate-3 hover:rotate-0 transition duration-500 border-4 border-white">
                </div>
            </div>
        </section>

        <!-- Menu Highlights -->
        <section id="menu-section" class="py-20 bg-gray-50">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-serif font-bold text-gray-900 mb-4">Our Favorites</h2>
                    <div class="w-24 h-1 bg-primary mx-auto"></div>
                    <p class="mt-4 text-gray-600">Handpicked dishes that our customers love the most.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                    <!-- Item 1 -->
                    <div class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition duration-300 overflow-hidden group">
                        <div class="h-56 overflow-hidden relative">
                            <span class="absolute top-4 left-4 bg-gold text-black text-xs font-bold px-3 py-1 rounded z-10">BESTSELLER</span>
                            <img src="https://images.unsplash.com/photo-1606471191009-63994c53433b?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" class="w-full h-full object-cover transform group-hover:scale-110 transition duration-500">
                        </div>
                        <div class="p-8">
                            <div class="flex justify-between items-baseline mb-2">
                                <h3 class="text-xl font-bold text-gray-800">Champaran Mutton</h3>
                                <span class="text-2xl font-bold text-primary">₹250</span>
                            </div>
                            <p class="text-gray-500 mb-6 text-sm">Slow-cooked in sealed earthen pots with whole garlic & secret spices.</p>
                            <button class="w-full py-3 bg-green-100 text-green-700 font-bold rounded-xl hover:bg-green-600 hover:text-white transition duration-300 book-trigger">
                                Reserve Order
                            </button>
                        </div>
                    </div>

                    <!-- Item 2 -->
                    <div class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition duration-300 overflow-hidden group">
                        <div class="h-56 overflow-hidden relative">
                            <span class="absolute top-4 left-4 bg-primary text-white text-xs font-bold px-3 py-1 rounded z-10">AUTHENTIC</span>
                            <img src="https://media.istockphoto.com/id/1141088469/photo/litti-chokha-in-white-plate-isolated-on-white-background.jpg?s=612x612&w=0&k=20&c=wXWk5_c2pGzoI4dJ5FpQ29h5D1sQfC_qX_f_k_X_x_c=" class="w-full h-full object-cover transform group-hover:scale-110 transition duration-500">
                        </div>
                        <div class="p-8">
                            <div class="flex justify-between items-baseline mb-2">
                                <h3 class="text-xl font-bold text-gray-800">Litti Chokha</h3>
                                <span class="text-2xl font-bold text-primary">₹120</span>
                            </div>
                            <p class="text-gray-500 mb-6 text-sm">Traditional sattu litti dipped in pure desi ghee served with baigan chokha.</p>
                            <button class="w-full py-3 bg-green-100 text-green-700 font-bold rounded-xl hover:bg-green-600 hover:text-white transition duration-300 book-trigger">
                                Reserve Order
                            </button>
                        </div>
                    </div>

                    <!-- Item 3 -->
                    <div class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition duration-300 overflow-hidden group">
                        <div class="h-56 overflow-hidden relative">
                            <span class="absolute top-4 left-4 bg-gray-800 text-white text-xs font-bold px-3 py-1 rounded z-10">SNACK</span>
                            <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" class="w-full h-full object-cover transform group-hover:scale-110 transition duration-500">
                        </div>
                        <div class="p-8">
                            <div class="flex justify-between items-baseline mb-2">
                                <h3 class="text-xl font-bold text-gray-800">Crispy Burger</h3>
                                <span class="text-2xl font-bold text-primary">₹149</span>
                            </div>
                            <p class="text-gray-500 mb-6 text-sm">Juicy patty, fresh garden lettuce, melted cheese and cafe-style fries.</p>
                            <button class="w-full py-3 bg-green-100 text-green-700 font-bold rounded-xl hover:bg-green-600 hover:text-white transition duration-300 book-trigger">
                                Reserve Order
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Feature Section -->
        <section class="py-24 bg-dark text-white relative overflow-hidden">
            <div class="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
            <div class="container mx-auto px-6 relative z-10">
                <div class="flex flex-col md:flex-row items-center gap-16">
                    <div class="w-full md:w-1/2">
                        <div class="relative">
                            <div class="absolute inset-0 border-4 border-gold transform translate-x-4 translate-y-4 rounded-lg"></div>
                            <img src="https://images.unsplash.com/photo-1606471191009-63994c53433b?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" class="relative rounded-lg shadow-2xl w-full">
                        </div>
                    </div>
                    <div class="w-full md:w-1/2">
                        <h2 class="text-5xl font-serif font-bold text-gold mb-6">Ahuna Mutton Handi</h2>
                        <h3 class="text-2xl font-light mb-8 text-gray-300">The Taste of Tradition.</h3>
                        <p class="text-gray-400 text-lg leading-relaxed mb-8">
                            Our chefs prepare this delicacy with patience and passion. Using secret spice blends from Champaran, sealed in clay pots to retain every ounce of flavor. It's not just food, it's an emotion.
                        </p>
                        <a href="#booking-section" class="inline-block px-8 py-3 border-2 border-gold text-gold font-bold rounded hover:bg-gold hover:text-black transition duration-300">
                            Book Your Handi
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Booking Section -->
        <section id="booking-section" class="py-24 bg-cover bg-center relative" style="background-image: url('https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1920&q=80');">
            <div class="absolute inset-0 bg-black bg-opacity-70"></div>
            <div class="container mx-auto px-6 relative z-10">
                <div class="max-w-3xl mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden">
                    <div class="p-10 md:p-14">
                        <div class="text-center mb-10">
                            <h2 class="text-3xl font-serif font-bold text-gray-800">Secure Your Table</h2>
                            <p class="text-gray-500">Reserve your spot instantly online.</p>
                        </div>

                        <form id="bookingForm" class="space-y-6">
                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Full Name</label>
                                    <input type="text" id="name" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:bg-white transition" placeholder="Amit Kumar" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Phone Number</label>
                                    <input type="tel" id="phone" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:bg-white transition" placeholder="9876543210" required>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Date</label>
                                    <input type="date" id="date" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:bg-white transition" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Time</label>
                                    <input type="time" id="time" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:bg-white transition" required>
                                </div>
                            </div>

                            <div class="grid md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Guests</label>
                                    <select id="guests" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:bg-white transition">
                                        <option value="2">2 People</option>
                                        <option value="4">4 People</option>
                                        <option value="6">6 People</option>
                                        <option value="8">8 People</option>
                                        <option value="10+">10+ (Group)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-bold text-gray-700 mb-2">Seating</label>
                                    <select id="seating" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:bg-white transition">
                                        <option value="Indoor AC">Indoor AC Hall</option>
                                        <option value="Rooftop">Rooftop (Open Air)</option>
                                        <option value="Private Cabin">Private Family Cabin</option>
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2">Special Requests</label>
                                <textarea id="notes" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-primary focus:bg-white transition" rows="2" placeholder="Birthday, Anniversary, Less Spicy..."></textarea>
                            </div>

                            <button type="submit" class="w-full py-4 bg-primary text-white font-bold rounded-xl shadow-lg hover:bg-red-700 transform hover:-translate-y-1 transition duration-300">
                                Confirm Reservation
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-dark text-white py-12 text-center">
            <div class="container mx-auto px-6">
                <h3 class="text-2xl font-serif font-bold mb-2">MG Cafe & Restro</h3>
                <p class="text-gray-400 mb-8">Danapur, Patna, Bihar 801503</p>
                <div class="flex justify-center gap-4 mb-8">
                    <a href="#" class="w-10 h-10 rounded-full bg-white bg-opacity-10 flex items-center justify-center hover:bg-primary transition"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="w-10 h-10 rounded-full bg-white bg-opacity-10 flex items-center justify-center hover:bg-primary transition"><i class="fab fa-instagram"></i></a>
                </div>
                <p class="text-sm text-gray-600">&copy; 2025 Swad-E-Bihar. All Rights Reserved.</p>
            </div>
        </footer>

    </main>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 hidden backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full mx-4 text-center transform transition-all scale-100 shadow-2xl">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-check text-green-600 text-3xl"></i>
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Booking Received!</h3>
            <p class="text-gray-600 mb-6">
                Thanks <span id="modalName" class="font-bold text-gray-800"></span>! We have received your request for <span id="modalDate" class="font-bold"></span>. We will call you to confirm.
            </p>
            <button onclick="document.getElementById('successModal').classList.add('hidden')" class="w-full py-3 bg-gray-900 text-white rounded-xl font-bold hover:bg-gray-800 transition">
                Okay, Great!
            </button>
        </div>
    </div>

    <!-- Mobile Sticky Bar -->
    <div class="fixed bottom-0 left-0 w-full bg-white border-t flex md:hidden z-40 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)]">
        <a href="tel:+911234567890" class="flex-1 py-4 text-center font-bold text-secondary border-r flex items-center justify-center gap-2">
            <i class="fas fa-phone-alt"></i> Call
        </a>
        <a href="#booking-section" class="flex-1 py-4 text-center font-bold text-white bg-primary flex items-center justify-center gap-2">
            <i class="fas fa-calendar-check"></i> Book Table
        </a>
    </div>

    <!-- FIREBASE & LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp, doc, getDoc, signInAnonymously, getAuth } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";
        import { getAuth as getFirebaseAuth } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";

        // --- FIREBASE CONFIGURATION ---
        // We use the environment's config to ensure it works in this preview.
        // For your local deployment, you can uncomment your specific keys below.
        
        let firebaseConfig;
        if (typeof __firebase_config !== 'undefined') {
            firebaseConfig = JSON.parse(__firebase_config);
        } else {
             // FALLBACK: User's provided keys (for local use)
             firebaseConfig = {
                apiKey: "AIzaSyCdjr6GwvNtC-qqLhX7X0eOCZk54orEBto",
                authDomain: "fir-711c2.firebaseapp.com",
                projectId: "fir-711c2",
                storageBucket: "fir-711c2.firebasestorage.app",
                messagingSenderId: "212609923784",
                appId: "1:212609923784:web:43c274cea203256e2943fd",
            };
        }

        const app = initializeApp(firebaseConfig);
        const auth = getFirebaseAuth(app);
        const db = getFirestore(app);
        
        // Use App ID for path isolation (Security Best Practice)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app';

        // 1. Authenticate & Load Content
        async function initApp() {
            try {
                // Must auth before DB access (Rule #3)
                await signInAnonymously(auth);
                console.log("Authenticated.");
                
                await loadDynamicContent();
            } catch(e) {
                console.error("Auth failed:", e);
                // Even if auth fails, show the default static content
                showContent();
            }
        }

        async function loadDynamicContent() {
            try {
                // Path Rule #1: Use public/data
                const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'site_content', 'live_page');
                const docSnap = await getDoc(docRef);

                if (docSnap.exists() && docSnap.data().html) {
                    console.log("Loading live content from Firebase...");
                    document.getElementById('editable-content').innerHTML = docSnap.data().html;
                } else {
                    console.log("Using default local content.");
                }
            } catch (e) {
                console.warn("Could not load dynamic content (likely offline or first run):", e);
            } finally {
                showContent();
            }
        }
        
        function showContent() {
            const screen = document.getElementById('loading-screen');
            const content = document.getElementById('editable-content');
            
            screen.style.opacity = '0';
            setTimeout(() => {
                screen.style.display = 'none';
                content.classList.remove('opacity-0');
                bindEvents(); // Re-bind events to new content
            }, 500);
        }

        function bindEvents() {
            // "Book This" Scroll
            document.querySelectorAll('.book-trigger').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById('booking-section').scrollIntoView({behavior: 'smooth'});
                });
            });

            // Form Submit
            const form = document.getElementById('bookingForm');
            if(form) {
                // Clone to remove old listeners
                const newForm = form.cloneNode(true);
                form.parentNode.replaceChild(newForm, form);
                newForm.addEventListener('submit', handleFormSubmit);
            }
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            const originalText = btn.innerText;
            
            // Visual Feedback
            btn.innerText = "Booking...";
            btn.disabled = true;
            btn.classList.add('opacity-75');

            const name = document.getElementById('name').value;
            const date = document.getElementById('date').value;
            const guests = document.getElementById('guests').value;

            try {
                // Path Rule #1: Use public/data for bookings
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'bookings'), {
                    name: name,
                    phone: document.getElementById('phone').value,
                    date: date,
                    time: document.getElementById('time').value,
                    guests: guests,
                    seating: document.getElementById('seating').value,
                    notes: document.getElementById('notes').value,
                    status: 'Pending',
                    timestamp: serverTimestamp()
                });

                // Success UI
                document.getElementById('modalName').innerText = name;
                document.getElementById('modalDate').innerText = date;
                document.getElementById('successModal').classList.remove('hidden');
                e.target.reset();

            } catch (error) {
                console.error("Booking error:", error);
                alert("Could not connect to server. Please try again.");
            }

            btn.innerText = originalText;
            btn.disabled = false;
            btn.classList.remove('opacity-75');
        }

        // Start
        initApp();
    </script>
</body>
</html>
